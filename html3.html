@app.route('/reject_access_request', methods=['POST'])
@login_required
@priviliges_check('ADMIN')
def reject_access_request():
    try:
        data = request.get_json()
        request_id = data.get('request_id')
        
        if not request_id:
            return jsonify({'success': False, 'error': 'Missing request_id parameter'})
        
        conn = get_db_connection()
        cursor = conn.cursor()
        
        # Просто меняем статус запроса на I (отклонен)
        cursor.execute(
            "UPDATE webplatform.reg_requests SET status = 'I' WHERE id = %s",
            (request_id,)
        )
        
        conn.commit()
        cursor.close()
        conn.close()
        
        return jsonify({
            'success': True, 
            'message': 'Запрос успешно отклонен'
        })
        
    except Exception as e:
        print(f"Error rejecting access request: {e}")
        return jsonify({'success': False, 'error': str(e)})
